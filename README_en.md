# SwitchBot Controller

[日本語のREADMEはこちら](README.md)

Electron-based desktop client for controlling your SwitchBot devices via the official SwitchBot Cloud API.  
Built with React (Vite) + MUI + Redux Toolkit, and supports both English and Japanese UI.

Approximately 99% of this app’s source code was generated by AI, and it has not undergone thorough manual testing or code review by humans.  
The author assumes no responsibility or liability for any issues, malfunctions, or damages affecting your computer, SwitchBot devices, account, or network environment that may arise from using this software. Use it entirely at your own risk.

## Features
- List all devices with filtering and detail view
- Control supported physical devices (status retrieval, on/off, position, etc.)
- Send custom commands to infrared remote devices registered in SwitchBot
- List and execute scenes with a single click
- Store and validate API Token / Secret, configure polling interval, theme (light/dark/system), and language (en/ja)
- Restore last opened screen and automatically poll device status in the background

## Supported Devices

See [Device Support Matrix / 対応デバイス一覧](DEVICE_SUPPORT_MATRIX.md) for the full list of devices from the official SwitchBot API documentation and their support status (`〇` / `△` / `?` / `×`) in this app.

## Requirements
- Node.js 20 or later (recommended, Electron 36 based)
- npm
- A SwitchBot account and Cloud API **Open Token** and **Secret Key** (configured inside the app under `Settings`)

## How to Use the App (End Users)
1. Get your SwitchBot Cloud API **Open Token** and **Secret Key** from the official SwitchBot mobile app  
   (Cloud Services → Developer options; see the official SwitchBot documentation for details).
2. Start the app:
   - If you have a packaged build (installer / AppImage / dmg): install and launch it as a normal desktop application.
   - If you are running from source, see the “Developer Setup” section below and run `npm run dev` (development mode).
3. Open the `Settings` tab in the top app bar.
4. Enter your **Open Token** and **Secret Key**, then click `Validate and Save`.
   - If validation succeeds, the app stores the credentials locally and automatically starts using them.
   - You can clear stored credentials at any time using `Clear Stored Credentials`.
5. (Optional) Configure:
   - **Polling Interval**: how often physical device statuses are refreshed (seconds). Set `0` to disable polling.
   - **Theme**: `Light`, `Dark`, or `Follow System`.
   - **Language**: `English` or `Japanese`.
6. Switch to the `Devices` tab:
   - Check device status in the list and open details to view more properties.
   - For supported devices, use the control panel to perform operations (e.g., on/off, mode change).
   - For infrared remotes, execute registered commands from the UI.
7. Switch to the `Scenes` tab:
   - Load scenes from your SwitchBot Cloud account.
   - Execute scenes with one click.

## Developer Setup Guide

### 1. Clone and install
```bash
git clone https://github.com/0suu/SwitchBotController.git
cd SwitchBotController
npm install
```

### 2. Development run (hot reload)
```bash
npm run dev
```
This starts Vite (renderer) and Electron (main) in parallel.  
After startup, open the `Settings` screen and register / validate your API Token and Secret.

If you prefer to run the built app instead of development mode, first build and then start Electron:
```bash
npm run build
npm run start
```

### 3. Tests
```bash
npm test           # Run unit tests
npm run test:coverage
```

### 4. Build & packaging
```bash
npm run build      # Build renderer and main
npm run package    # Generate platform-specific installers into release/
```
On macOS / Linux builds, make sure the following assets exist (replace with your own if necessary):
- `assets/icon.icns`
- `assets/icon.png`

Electron Builder uses the configuration defined in `package.json` (`build` field) for app ID, product name, and targets.

Dependency licenses are generated via `npm run build:licenses` (automatically executed inside `npm run build`) into `build/licenses/THIRD_PARTY_LICENSES.txt`, and Electron Builder bundles that file together with the root `LICENSE` in the installers. Re-run the script after dependency changes to refresh the list.

## Project Structure (Overview)
- `src/main/` – Electron main process. Exposes IPC handlers for SwitchBot API and manages `electron-store` for settings and credentials.
- `src/preload/` – Preload scripts that bridge the main process and renderer (e.g., `electronStore`, `switchBotBridge`).
- `src/renderer/` – React + Vite frontend implementing device list/detail, scenes, and settings screens.
- `src/api/` – SwitchBot API type definitions, helpers, and request wrappers.

## Security Notes
- API Token and Secret Key are stored using `electron-store`.  
  These values are not encrypted and can be read by the local OS user.

Handle and distribute builds with the same level of care as any application that stores API credentials.

## License
ISC License
